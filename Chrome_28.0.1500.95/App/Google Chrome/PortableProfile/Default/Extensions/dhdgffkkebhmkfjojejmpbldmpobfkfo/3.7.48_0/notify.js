Registry.require(["prepare","icon"],function(){var l=Registry.get("icon"),m=Registry.prepare(),p=!1,q=null,h={notify:function(a,b,e,c,f,d){var h=!1;d||(h=!0,d=function(){});l.getDataUriFromUrl(e||chrome.extension.getURL("images/icon128.png"),function(l){var g=null,n=!1,k=null,r=function(){k&&window.clearTimeout(k);n||d({})},s=function(){n=!0;var a={clicked:n};f?chrome.permissions.request({permissions:[f]},function(b){a.granted=b;d&&d(a)}):d&&d(a);g&&g.cancel()};try{g=q.createNotification(l,a||"",
b||"")}catch(m){console.warn("notify: Notification creation failed with: "+m.message);h||window.setTimeout(function(){confirm((a?a+"\n\n":"")+b)?s():r()},1);return}g.onclose=r;g.onclick=s;k=window.setTimeout(function(){k=null;g.cancel()},c?c:6E5);p&&console.debug("notify:",a,b,e,c,f);g.show()})},getPermission:function(a,b,e,c,f,d){h.notify(a,b,e,c,f,d)},showUpdate:function(a,b,e,c){h.notify(a,b,e,3E5,null,c)},show:function(a,b,e,c,f){h.notify(a,b,e,c,null,f)},debug:function(a){p=a}};Registry.register("notify",
"48",function(){q=m.HTML5.WEBKITNOTIFICATIONS;return h})});
